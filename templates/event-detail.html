{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}
<section>



<!-- Modal -->
<div
  class="modal fade"
  id="commentModal"
  data-mdb-backdrop="static"
  data-mdb-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Add a comment</h5>
        <button
          type="button"
          class="btn-close"
          data-mdb-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <form method="POST">
      <div class="modal-body">
          {% csrf_token %}
          {{form | crispy }}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">
          Close
        </button>
        <button type="submit" class="btn btn-primary">Post the Comment</button>
      </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade"
  id="DeleteModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true" >
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Delete this Event</h5>
        <button
          type="button"
          class="btn-close"
          data-mdb-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">Are you sure you want to delete the selected event?</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">
          Close
        </button>
        <a type="submit" class="btn btn-danger" href="{% url 'event-delete' event_id=data.id %}">
          Yes I'm Sure
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Modal for signing up for the event -->
<div
  class="modal fade"
  id="SignupeventModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Signup for this event</h5>
        <button
          type="button"
          class="btn-close"
          data-mdb-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">
          Close
        </button>
        <a class="btn btn-danger" href="{% url 'signup-event' id=data.id %}">Sign up for the event</a>
      </div>
    </div>
  </div>
</div>


{% if not request.user in data.accepted_users.all %}
<button
  type="button"
  class="btn btn-primary mb-2"
  data-mdb-toggle="modal"
  data-mdb-target="#SignupeventModal">
  Signup for this event
</button>
{% endif %}

<!-- Button trigger modal -->




<div class="row">
  <div class="col-lg-6">
    <ol class="list-group ">
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Registered Academic Ambassador (Y/N)</div>
          {{data.ambassodor}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Event Date</div>
          {{data.date}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Quarter</div>
          {{data.quarter}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Event/Activity Type</div>
          {{data.event_activity_type}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Technology Track</div>
          {{data.technology_tracks}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Event/Activity Mode</div>
          {{data.event_activity_mode}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Organized By</div>
          {{data.organised_by}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Comments</div>
          <ul class="list-group">
          {% for entry in data.get_comments %}
            <li class="list-group-item">
              {{entry.comment}}
            </li>
          {% endfor %}
          </ul>
        </div>
      </li>
    </ol>
  </div>
  <div class="col-lg-6">
    <ol class="list-group">
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Session Topic Name</div>
          {{data.session_topic_name}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Session Duration in hours (1 - 8)</div>
          {{data.session_duration}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">No. of attendees</div>
          {{data.number_of_attendees}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Institution Name</div>
          {{data.institution_name.college_name}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Institution City</div>
          {{data.institution_name.college_city}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Subject Matter Expert (SME) Name</div>
          {{data.sme_details.sme_name}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">SME Notes ID</div>
          {{data.sme_details.sme_notes_id}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">SME Manager Notes ID</div>
          {{data.sme_details.sme_manager_notes_id}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Link of Academic Initiative </div>
          {{data.link}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">Status </div>
          {{data.status}}
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
          <div class="fw-bold">College Category</div>
          {{data.college_category}}
        </div>
      </li>
    </ol>
  </div>
</div>

<br>

{% comment %} {% if user.is_superuser %}
<div class="row">
  <ol>
    {% for user in data.accepted_users.all %}
      <li>{{user.username}}</li>
    {% endfor %}
  </ol>
</div>
{% endif %} {% endcomment %}


<div class="row">
  <div class="col mb-3">
  {% if user.is_superuser %}
          {% if data.publish %}
          <form method="POST">
              {% csrf_token %}
              <input type="hidden" name="hidden_option" value="0">
              <button type="submit"
                      class="btn btn-info btn-block">
                        Unpublish the Event
              </button>
          </form>
        {% endif %}


        {% if not data.publish %}
          <form method="POST">
              {% csrf_token %}
              <input type="hidden" name="hidden_option" value="1">
              <button type="submit"
                      class="btn btn-info btn-block">
                        Publish the Event
              </button>
          </form>
        {% endif %}
  {% endif %}
  </div>
  <div class="col mb-3">
    <button type="button" class="btn btn-primary btn-block" data-mdb-toggle="modal" data-mdb-target="#commentModal">
      Add a comment
    </button>
  </div>
  <div class="col mb-3">
  {% if user.is_superuser %}
    <button type="button" class="btn btn-danger btn-block" data-mdb-toggle="modal" data-mdb-target="#DeleteModal">Delete this event</button>
  {% endif %}
  </div>
  <div class="col mb-3">
  {% if user.is_superuser %}
    <a class="btn btn-success btn-block" href="{% url 'event-update' event_id=data.id %}">Update this event</a>
  {% endif %}
  </div>
  <div class="col mb-3">
  {% if user.is_superuser %}
    <a class="btn btn-success btn-block" href="{% url 'event-assign' id=data.id %}">Assign this event</a>
  {% endif %}
  </div>
</div>





<br>

</section>


{% endblock content %}


